<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:WorkoutTracker.ViewModels"
             x:Class="WorkoutTracker.Views.TimerPageView"
             x:DataType="vm:TimerViewModel"
             Shell.NavBarIsVisible="False"
             BackgroundColor="{StaticResource BackgroundPrimary}">

    <Grid RowDefinitions="Auto, *, Auto" Padding="20,10">

        <Grid Grid.Row="0" ColumnDefinitions="Auto, *, Auto" HeightRequest="60">
            <Button Grid.Column="0" 
                    Text="✕" 
                    Command="{Binding CloseCommand}"
                    BackgroundColor="{StaticResource BackgroundInput}"
                    TextColor="{StaticResource TextSecondary}"
                    CornerRadius="20"
                    WidthRequest="40" HeightRequest="40" Padding="0"/>

            <VerticalStackLayout Grid.Column="1" HorizontalOptions="Center" VerticalOptions="Center">
                <Label Text="ПРОГРЕСС" Style="{StaticResource LabelCaption}" HorizontalOptions="Center"/>
                <Label Text="{Binding WorkoutProgress}" Style="{StaticResource LabelBody}" FontAttributes="Bold"/>
            </VerticalStackLayout>

            <VerticalStackLayout Grid.Column="2" HorizontalOptions="End" VerticalOptions="Center">
                <Label Text="ОСТАЛОСЬ" Style="{StaticResource LabelCaption}" HorizontalOptions="Center"/>
                <Label Text="{Binding RemainingTime}" TextColor="{StaticResource AccentMain}" FontAttributes="Bold" HorizontalOptions="Center"/>
            </VerticalStackLayout>
        </Grid>

        <Grid Grid.Row="1" HorizontalOptions="Center" VerticalOptions="Center">
            <Ellipse WidthRequest="300" HeightRequest="300" 
                     Stroke="{StaticResource BackgroundCard}" StrokeThickness="20"/>

            <Ellipse WidthRequest="300" HeightRequest="300" 
                     StrokeThickness="20" StrokeLineCap="Round">
                <Ellipse.Triggers>
                    <DataTrigger TargetType="Ellipse" Binding="{Binding IsWorkPhase}" Value="True">
                        <Setter Property="Stroke" Value="{StaticResource AccentWork}"/>
                    </DataTrigger>
                    <DataTrigger TargetType="Ellipse" Binding="{Binding IsWorkPhase}" Value="False">
                        <Setter Property="Stroke" Value="{StaticResource AccentRest}"/>
                    </DataTrigger>
                </Ellipse.Triggers>
            </Ellipse>

            <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center" Spacing="0">
                <Label Text="{Binding IsWorkPhase, Converter={StaticResource BoolToTextConverter}}" 
                       FontSize="16" TextTransform="Uppercase"
                       HorizontalOptions="Center" Margin="0,0,0,10">
                    <Label.Triggers>
                        <DataTrigger TargetType="Label" Binding="{Binding IsWorkPhase}" Value="True">
                            <Setter Property="TextColor" Value="{StaticResource AccentWork}"/>
                            <Setter Property="Text" Value="РАБОТА"/>
                        </DataTrigger>
                        <DataTrigger TargetType="Label" Binding="{Binding IsWorkPhase}" Value="False">
                            <Setter Property="TextColor" Value="{StaticResource AccentRest}"/>
                            <Setter Property="Text" Value="ОТДЫХ"/>
                        </DataTrigger>
                    </Label.Triggers>
                </Label>

                <Label Text="{Binding CurrentTime}" 
                       Style="{StaticResource LabelHero}" 
                       HorizontalOptions="Center"/>
            </VerticalStackLayout>
        </Grid>

        <Grid Grid.Row="2" ColumnDefinitions="Auto, *, Auto" Margin="0,0,0,30">

            <Button Grid.Column="0" Command="{Binding PreviousCommand}" Text="❮"
                    BackgroundColor="{StaticResource BackgroundInput}" TextColor="White"
                    WidthRequest="60" HeightRequest="60" CornerRadius="30"/>

            <Button Grid.Column="1" 
                    Command="{Binding PauseCommand}"
                    Text="{Binding PauseButtonFullText}"
                    CornerRadius="35"
                    HeightRequest="70"
                    Margin="20,0"
                    FontSize="20" FontAttributes="Bold" TextColor="White">
                <Button.Shadow>
                    <Shadow Brush="Black" Offset="0,4" Radius="10" Opacity="0.5"/>
                </Button.Shadow>
                <Button.Triggers>
                    <DataTrigger TargetType="Button" Binding="{Binding IsWorkPhase}" Value="True">
                        <Setter Property="Background" Value="{StaticResource GradientWork}"/>
                        <Setter Property="TextColor" Value="Black"/>
                    </DataTrigger>
                    <DataTrigger TargetType="Button" Binding="{Binding IsWorkPhase}" Value="False">
                        <Setter Property="Background" Value="{StaticResource GradientRest}"/>
                        <Setter Property="TextColor" Value="White"/>
                    </DataTrigger>
                </Button.Triggers>
            </Button>

            <Button Grid.Column="2" Command="{Binding NextCommand}" Text="❯"
                    BackgroundColor="{StaticResource BackgroundInput}" TextColor="White"
                    WidthRequest="60" HeightRequest="60" CornerRadius="30"/>
        </Grid>
    </Grid>
</ContentPage>