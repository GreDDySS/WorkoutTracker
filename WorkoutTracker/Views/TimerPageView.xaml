<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:WorkoutTracker.ViewModels"
             x:Class="WorkoutTracker.Views.TimerPageView"
             x:DataType="vm:TimerViewModel"
             Title="Таймер"
             Shell.NavBarIsVisible="False">
    <ContentPage.Triggers>
        <DataTrigger TargetType="ContentPage" Binding="{Binding IsWorkPhase}" Value="True">
            <Setter Property="BackgroundColor" Value="{StaticResource WorkPhaseBackground}"/>
        </DataTrigger>
        <DataTrigger TargetType="ContentPage" Binding="{Binding IsWorkPhase}" Value="False">
            <Setter Property="BackgroundColor" Value="{StaticResource RestPhaseBackground}"/>
        </DataTrigger>
    </ContentPage.Triggers>
    
    <Grid RowDefinitions="Auto, *, Auto" RowSpacing="0">
        <Grid.Triggers>
            <DataTrigger TargetType="Grid" Binding="{Binding IsWorkPhase}" Value="True">
                <Setter Property="BackgroundColor" Value="{StaticResource WorkPhaseBackground}"/>
            </DataTrigger>
            <DataTrigger TargetType="Grid" Binding="{Binding IsWorkPhase}" Value="False">
                <Setter Property="BackgroundColor" Value="{StaticResource RestPhaseBackground}"/>
            </DataTrigger>
        </Grid.Triggers>
        
        <Grid Grid.Row="0" 
              ColumnDefinitions="Auto, *" 
              Padding="15,15,15,20">
            <Grid.Triggers>
                <DataTrigger TargetType="Grid" Binding="{Binding IsWorkPhase}" Value="True">
                    <Setter Property="BackgroundColor" Value="{StaticResource WorkPhaseBackground}"/>
                </DataTrigger>
                <DataTrigger TargetType="Grid" Binding="{Binding IsWorkPhase}" Value="False">
                    <Setter Property="BackgroundColor" Value="{StaticResource RestPhaseBackground}"/>
                </DataTrigger>
            </Grid.Triggers>
            
            <Button Grid.Column="0"
                    Command="{Binding CloseCommand}"
                    CornerRadius="8"
                    WidthRequest="40"
                    HeightRequest="40"
                    Padding="0"
                    BorderWidth="0"
                    Text="×"
                    TextColor="White"
                    FontSize="24"
                    FontAttributes="Bold">
                <Button.Triggers>
                    <DataTrigger TargetType="Button" Binding="{Binding IsWorkPhase}" Value="True">
                        <Setter Property="BackgroundColor" Value="{StaticResource WorkPhaseAccent}"/>
                    </DataTrigger>
                    <DataTrigger TargetType="Button" Binding="{Binding IsWorkPhase}" Value="False">
                        <Setter Property="BackgroundColor" Value="{StaticResource RestPhaseAccent}"/>
                    </DataTrigger>
                </Button.Triggers>
            </Button>
            
            <VerticalStackLayout Grid.Column="1"
                                 HorizontalOptions="Center"
                                 Spacing="{StaticResource SpacingXSmall}">
                <Label Text="ОСТАЛОСЬ"
                       Style="{StaticResource LabelCaption}"
                       FontAttributes="None"
                       HorizontalOptions="Center"/>
                <Label Text="{Binding RemainingTime}"
                       Style="{StaticResource LabelBody}"
                       FontSize="20"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"/>
            </VerticalStackLayout>
        </Grid>
        
        <VerticalStackLayout Grid.Row="1"
                             HorizontalOptions="Center"
                             VerticalOptions="Center"
                             Spacing="{StaticResource SpacingXLarge}">
            
            <Label Text="{Binding WorkoutProgress}"
                   Style="{StaticResource LabelBody}"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"/>
            
            <Label Text="{Binding CurrentTime}"
                   Style="{StaticResource LabelHero}"
                   HorizontalOptions="Center"/>
        </VerticalStackLayout>
        
        <Grid Grid.Row="2"
              ColumnDefinitions="Auto, *, Auto"
              Padding="15,20,15,30">
            
            <Grid.Triggers>
                <DataTrigger TargetType="Grid" Binding="{Binding IsWorkPhase}" Value="True">
                    <Setter Property="BackgroundColor" Value="{StaticResource WorkPhaseBackground}"/>
                </DataTrigger>
                <DataTrigger TargetType="Grid" Binding="{Binding IsWorkPhase}" Value="False">
                    <Setter Property="BackgroundColor" Value="{StaticResource RestPhaseBackground}"/>
                </DataTrigger>
            </Grid.Triggers>
            
            <Button Grid.Column="0"
                    Command="{Binding PreviousCommand}"
                    Style="{StaticResource ButtonIconLarge}"
                    Text="««"
                    FontSize="20">
                <Button.Triggers>
                    <DataTrigger TargetType="Button" 
                                 Binding="{Binding IsWorkPhase}" 
                                 Value="True">
                        <Setter Property="BackgroundColor" 
                                Value="{StaticResource WorkPhaseAccent}"/>
                    </DataTrigger>
                    <DataTrigger TargetType="Button" 
                                 Binding="{Binding IsWorkPhase}" 
                                 Value="False">
                        <Setter Property="BackgroundColor" 
                                Value="{StaticResource RestPhaseAccent}"/>
                    </DataTrigger>
                </Button.Triggers>
            </Button>

            <Button Grid.Column="1"
                    Command="{Binding PauseCommand}"
                    Style="{StaticResource ButtonPrimary}"
                    Margin="15,0"
                    Text="{Binding PauseButtonFullText}"
                    FontSize="{StaticResource FontSizeMedium}"/>

            <Button Grid.Column="2"
                    Command="{Binding NextCommand}"
                    Style="{StaticResource ButtonIconLarge}"
                    Text="»»"
                    FontSize="20">
                <Button.Triggers>
                    <DataTrigger TargetType="Button" 
                                 Binding="{Binding IsWorkPhase}" 
                                 Value="True">
                        <Setter Property="BackgroundColor" 
                                Value="{StaticResource WorkPhaseAccent}"/>
                    </DataTrigger>
                    <DataTrigger TargetType="Button" 
                                 Binding="{Binding IsWorkPhase}" 
                                 Value="False">
                        <Setter Property="BackgroundColor" 
                                Value="{StaticResource RestPhaseAccent}"/>
                    </DataTrigger>
                </Button.Triggers>
            </Button>
        </Grid>
    </Grid>
</ContentPage>