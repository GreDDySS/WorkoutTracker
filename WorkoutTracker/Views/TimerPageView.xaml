<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:WorkoutTracker.ViewModels"
             x:Class="WorkoutTracker.Views.TimerPageView"
             x:DataType="vm:TimerViewModel"
             Title="Таймер"
             Shell.NavBarIsVisible="False">
    <ContentPage.Triggers>
        <DataTrigger TargetType="ContentPage" Binding="{Binding IsWorkPhase}" Value="True">
            <Setter Property="BackgroundColor" Value="#2E7D32"/>
        </DataTrigger>
        <DataTrigger TargetType="ContentPage" Binding="{Binding IsWorkPhase}" Value="False">
            <Setter Property="BackgroundColor" Value="#1976D2"/>
        </DataTrigger>
    </ContentPage.Triggers>
    
    <Grid RowDefinitions="Auto, *, Auto" RowSpacing="0">
        <Grid.Triggers>
            <DataTrigger TargetType="Grid" Binding="{Binding IsWorkPhase}" Value="True">
                <Setter Property="BackgroundColor" Value="#2E7D32"/>
            </DataTrigger>
            <DataTrigger TargetType="Grid" Binding="{Binding IsWorkPhase}" Value="False">
                <Setter Property="BackgroundColor" Value="#1976D2"/>
            </DataTrigger>
        </Grid.Triggers>
        
        <!-- Header -->
        <Grid Grid.Row="0" 
              ColumnDefinitions="Auto, *" 
              Padding="15,15,15,20">
            <Grid.Triggers>
                <DataTrigger TargetType="Grid" Binding="{Binding IsWorkPhase}" Value="True">
                    <Setter Property="BackgroundColor" Value="#2E7D32"/>
                </DataTrigger>
                <DataTrigger TargetType="Grid" Binding="{Binding IsWorkPhase}" Value="False">
                    <Setter Property="BackgroundColor" Value="#1976D2"/>
                </DataTrigger>
            </Grid.Triggers>
            
            <!-- Close Button -->
            <Button Grid.Column="0"
                    Command="{Binding CloseCommand}"
                    CornerRadius="8"
                    WidthRequest="40"
                    HeightRequest="40"
                    Padding="0"
                    BorderWidth="0"
                    Text="×"
                    TextColor="White"
                    FontSize="24"
                    FontAttributes="Bold">
                <Button.Triggers>
                    <DataTrigger TargetType="Button" Binding="{Binding IsWorkPhase}" Value="True">
                        <Setter Property="BackgroundColor" Value="#4CAF50"/>
                    </DataTrigger>
                    <DataTrigger TargetType="Button" Binding="{Binding IsWorkPhase}" Value="False">
                        <Setter Property="BackgroundColor" Value="#2196F3"/>
                    </DataTrigger>
                </Button.Triggers>
            </Button>
            
            <!-- Center: Remaining Time -->
            <VerticalStackLayout Grid.Column="1"
                                 HorizontalOptions="Center"
                                 Spacing="5">
                <Label Text="ОСТАЛОСЬ"
                       TextColor="White"
                       FontSize="14"
                       FontAttributes="None"
                       HorizontalOptions="Center"/>
                <Label Text="{Binding RemainingTime}"
                       TextColor="White"
                       FontSize="20"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"/>
            </VerticalStackLayout>
        </Grid>
        
        <!-- Main Content -->
        <VerticalStackLayout Grid.Row="1"
                             HorizontalOptions="Center"
                             VerticalOptions="Center"
                             Spacing="30">
            
            <!-- Workout Progress -->
            <Label Text="{Binding WorkoutProgress}"
                   TextColor="White"
                   FontSize="18"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"/>
            
            <!-- Main Timer -->
            <Label Text="{Binding CurrentTime}"
                   TextColor="White"
                   FontSize="72"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"/>
        </VerticalStackLayout>
        
        <!-- Footer Controls -->
        <Grid Grid.Row="2"
              ColumnDefinitions="Auto, *, Auto"
              Padding="15,20,15,30">
            <Grid.Triggers>
                <DataTrigger TargetType="Grid" Binding="{Binding IsWorkPhase}" Value="True">
                    <Setter Property="BackgroundColor" Value="#2E7D32"/>
                </DataTrigger>
                <DataTrigger TargetType="Grid" Binding="{Binding IsWorkPhase}" Value="False">
                    <Setter Property="BackgroundColor" Value="#1976D2"/>
                </DataTrigger>
            </Grid.Triggers>
            
            <!-- Previous Button -->
            <Button Grid.Column="0"
                    Command="{Binding PreviousCommand}"
                    CornerRadius="8"
                    WidthRequest="50"
                    HeightRequest="50"
                    Padding="0"
                    BorderWidth="0"
                    Text="««"
                    TextColor="White"
                    FontSize="20"
                    FontAttributes="Bold">
                <Button.Triggers>
                    <DataTrigger TargetType="Button" Binding="{Binding IsWorkPhase}" Value="True">
                        <Setter Property="BackgroundColor" Value="#4CAF50"/>
                    </DataTrigger>
                    <DataTrigger TargetType="Button" Binding="{Binding IsWorkPhase}" Value="False">
                        <Setter Property="BackgroundColor" Value="#2196F3"/>
                    </DataTrigger>
                </Button.Triggers>
            </Button>
            
            <!-- Pause Button -->
            <Button Grid.Column="1"
                    Command="{Binding PauseCommand}"
                    BackgroundColor="White"
                    CornerRadius="10"
                    HeightRequest="50"
                    Margin="15,0"
                    BorderWidth="0"
                    Text="{Binding PauseButtonFullText}"
                    TextColor="Black"
                    FontSize="16"/>
            
            <!-- Next Button -->
            <Button Grid.Column="2"
                    Command="{Binding NextCommand}"
                    CornerRadius="8"
                    WidthRequest="50"
                    HeightRequest="50"
                    Padding="0"
                    BorderWidth="0"
                    Text="»»"
                    TextColor="White"
                    FontSize="20"
                    FontAttributes="Bold">
                <Button.Triggers>
                    <DataTrigger TargetType="Button" Binding="{Binding IsWorkPhase}" Value="True">
                        <Setter Property="BackgroundColor" Value="#4CAF50"/>
                    </DataTrigger>
                    <DataTrigger TargetType="Button" Binding="{Binding IsWorkPhase}" Value="False">
                        <Setter Property="BackgroundColor" Value="#2196F3"/>
                    </DataTrigger>
                </Button.Triggers>
            </Button>
        </Grid>
    </Grid>
</ContentPage>